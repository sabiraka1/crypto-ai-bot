markdown# crypto-ai-bot â€” Production-Ready Trading System

ğŸš€ **Enterprise-grade** ĞºÑ€Ğ¸Ğ¿Ñ‚Ğ¾-Ñ‚Ğ¾Ñ€Ğ³Ğ¾Ğ²Ğ°Ñ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ° Ğ½Ğ° **FastAPI** Ñ Ğ¿Ğ¾Ğ»Ğ½Ğ¾Ğ¹ Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸ĞµĞ¹ **Gate.io**, protective exits, reconciliation Ğ¸ production monitoring.

> **Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ:** Production-Ready | **ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¾:** 2025-08-19 | **ĞÑƒĞ´Ğ¸Ñ‚:** âœ… ĞŸÑ€Ğ¾Ğ¹Ğ´ĞµĞ½

---

## ğŸ¯ **ĞšĞ›Ğ®Ğ§Ğ•Ğ’Ğ«Ğ• ĞĞ¡ĞĞ‘Ğ•ĞĞĞĞ¡Ğ¢Ğ˜**

### **ğŸ’ Production Features**
- âœ… **Full Order Reconciliation** â€” Ğ°Ğ²Ñ‚Ğ¾ÑĞ²ĞµÑ€ĞºĞ° Ñ Ğ±Ğ¸Ñ€Ğ¶ĞµĞ¹ ĞºĞ°Ğ¶Ğ´Ñ‹Ğµ 60 ÑĞµĞº
- âœ… **Protective Exits** â€” Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ SL/TP Ñ Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³Ğ¾Ğ¼  
- âœ… **Circuit Breakers** â€” Ğ·Ğ°Ñ‰Ğ¸Ñ‚Ğ° Ğ¾Ñ‚ API ÑĞ±Ğ¾ĞµĞ² Ñ auto-recovery
- âœ… **Graceful Shutdown** â€” ĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ğ¾Ğµ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ¸Ğµ Ğ²ÑĞµÑ… Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¹
- âœ… **Comprehensive Monitoring** â€” 50+ Ğ¼ĞµÑ‚Ñ€Ğ¸Ğº Ğ´Ğ»Ñ production

### **ğŸ›¡ï¸ Risk Management**
- âœ… **Position Limits** â€” MAX_POSITIONS enforcement
- âœ… **Drawdown Protection** â€” Ğ°Ğ²Ñ‚Ğ¾ÑÑ‚Ğ¾Ğ¿ Ğ¿Ñ€Ğ¸ Ğ¿Ñ€ĞµĞ²Ñ‹ÑˆĞµĞ½Ğ¸Ğ¸ Ğ»Ğ¸Ğ¼Ğ¸Ñ‚Ğ¾Ğ²
- âœ… **Sequential Loss Limits** â€” Ğ·Ğ°Ñ‰Ğ¸Ñ‚Ğ° Ğ¾Ñ‚ ÑĞµÑ€Ğ¸Ğ¹ ÑƒĞ±Ñ‹Ñ‚ĞºĞ¾Ğ²
- âœ… **Time-based Trading** â€” Ñ‚Ğ¾Ñ€Ğ³Ğ¾Ğ²Ñ‹Ğµ Ñ‡Ğ°ÑÑ‹ Ğ¸ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ Ğ¾Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ‡ĞµĞ½Ğ¸Ñ

### **ğŸ”§ Gate.io Integration**
- âœ… **Native Symbol Format** â€” BTC_USDT Ğ´Ğ»Ñ Gate.io
- âœ… **Precision Handling** â€” Ğ¼Ğ¸Ğ½Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ Ğ»Ğ¾Ñ‚Ñ‹ Ğ¸ Ñ‚Ğ¾Ñ‡Ğ½Ğ¾ÑÑ‚ÑŒ
- âœ… **Rate Limit Management** â€” 300 calls/10sec ÑĞ¾Ğ±Ğ»ÑĞ´ĞµĞ½Ğ¸Ğµ
- âœ… **Status Mapping** â€” Ğ¿Ğ¾Ğ»Ğ½Ğ°Ñ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Gate.io ÑÑ‚Ğ°Ñ‚ÑƒÑĞ¾Ğ²

---

## ğŸ—ï¸ **ĞĞ Ğ¥Ğ˜Ğ¢Ğ•ĞšĞ¢Ğ£Ğ Ğ**
crypto-ai-bot/
â”œâ”€ requirements.txt
â”œâ”€ .env.example
â”œâ”€ ops/prometheus/          # ğŸ”¥ Production alerts
â”‚  â””â”€ alerts.yml           # 20+ production-ready rules
â”œâ”€ scripts/
â”‚  â”œâ”€ reconciler.py        # ğŸ”¥ Order reconciliation service
â”‚  â”œâ”€ protective_exits.py  # ğŸ”¥ SL/TP execution service
â”‚  â””â”€ health_monitor.py    # ğŸ”¥ System health monitoring
â””â”€ src/crypto_ai_bot/
â”œâ”€ app/
â”‚  â”œâ”€ server.py         # FastAPI + comprehensive health checks
â”‚  â”œâ”€ compose.py        # ğŸ”¥ Production DI container
â”‚  â””â”€ adapters/
â”‚     â””â”€ telegram.py    # Full command set: /eval, /why
â”œâ”€ core/
â”‚  â”œâ”€ settings.py       # ğŸ”¥ Production configuration
â”‚  â”œâ”€ orchestrator.py   # ğŸ”¥ Full lifecycle management
â”‚  â”œâ”€ use_cases/        # evaluate / eval_and_execute / place_order
â”‚  â”œâ”€ signals/
â”‚  â”‚  â”œâ”€ _build.py
â”‚  â”‚  â”œâ”€ _fusion.py     # ğŸ”¥ Signal fusion logic
â”‚  â”‚  â””â”€ policy.py
â”‚  â”œâ”€ brokers/
â”‚  â”‚  â”œâ”€ base.py
â”‚  â”‚  â”œâ”€ ccxt_impl.py   # ğŸ”¥ Renamed from ccxt_exchange.py
â”‚  â”‚  â””â”€ gateio_config.py # ğŸ”¥ Gate.io specific configuration
â”‚  â”œâ”€ risk/
â”‚  â”‚  â”œâ”€ manager.py     # ğŸ”¥ Enhanced risk rules
â”‚  â”‚  â””â”€ protective_exits.py # ğŸ”¥ SL/TP execution engine
â”‚  â””â”€ storage/
â”‚     â”œâ”€ reconciler.py  # ğŸ”¥ Order reconciliation
â”‚     â””â”€ repositories/  # trades, positions, exits, audit
â””â”€ utils/
â”œâ”€ retry.py          # ğŸ”¥ Centralized retry logic
â”œâ”€ circuit_breaker.py # ğŸ”¥ Enhanced with auto-recovery
â””â”€ graceful_shutdown.py # ğŸ”¥ Production shutdown handler

---

## âš¡ **Ğ‘Ğ«Ğ¡Ğ¢Ğ Ğ«Ğ™ Ğ¡Ğ¢ĞĞ Ğ¢**

### **1. Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ°**
```bash
# Development setup
python -m venv .venv
source .venv/bin/activate  # Linux/macOS
# .\.venv\Scripts\Activate.ps1  # Windows

pip install -r requirements.txt
# pip install -e .[dev]  # Ğ¡ development tools
2. ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ
bashcp .env.example .env
# ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹Ñ‚Ğµ .env Ñ„Ğ°Ğ¹Ğ» Ñ Ğ²Ğ°ÑˆĞ¸Ğ¼Ğ¸ API ĞºĞ»ÑÑ‡Ğ°Ğ¼Ğ¸
3. Ğ—Ğ°Ğ¿ÑƒÑĞº Development
bashexport PYTHONPATH=src
uvicorn crypto_ai_bot.app.server:app --reload --host 0.0.0.0 --port 8000
4. ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ¾ÑĞ¿Ğ¾ÑĞ¾Ğ±Ğ½Ğ¾ÑÑ‚Ğ¸
bash# Health check
curl http://localhost:8000/health

# Metrics
curl http://localhost:8000/metrics

# Telegram test (ĞµÑĞ»Ğ¸ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾ĞµĞ½)
# ĞÑ‚Ğ¿Ñ€Ğ°Ğ²ÑŒÑ‚Ğµ /status Ğ² Telegram Ğ±Ğ¾Ñ‚

ğŸš€ PRODUCTION DEPLOYMENT
Railway.app (Ğ ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´ÑƒĞµÑ‚ÑÑ)
bash# 1. Deploy
railway login
railway init
railway up

# 2. Environment Variables  
railway variables set MODE=live
railway variables set ENABLE_TRADING=true
railway variables set DB_PATH=/data/bot.sqlite
railway variables set GATEIO_API_KEY="your_key"
railway variables set GATEIO_API_SECRET="your_secret"

# 3. Volume Ğ´Ğ»Ñ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
railway volume create --name trading-data --mount /data

# 4. ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³
railway logs --follow
Docker (Alternative)
dockerfileFROM python:3.12-slim
WORKDIR /app
COPY requirements.txt .
RUN pip install -r requirements.txt
COPY src/ ./src/
ENV PYTHONPATH=src
EXPOSE 8000
CMD ["gunicorn", "-k", "uvicorn.workers.UvicornWorker", "-b", "0.0.0.0:8000", "crypto_ai_bot.app.server:app"]

ğŸ“Š MONITORING & OBSERVABILITY
ĞšĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸
yaml# Trading Metrics
- orders_success_total / orders_fail_total
- position_sync_drift_seconds  
- protective_exits_triggered_total
- slippage_actual_bps vs slippage_expected_bps
- pnl_calculated vs pnl_exchange_difference

# System Metrics  
- reconciliation_errors_total
- circuit_breaker_state{name,state}
- graceful_shutdown_duration_seconds
- risk_blocks_total{rule}

# Performance Metrics
- latency_decision_seconds (P95/P99)
- latency_order_execution_seconds (P95/P99) 
- performance_budget_exceeded_total{component}
Alerts (Prometheus)
yaml# Critical Alerts
- TradingSystemDown (1min)
- OrderReconciliationFailed (2min)  
- ProtectiveExitStuck (5min)
- DrawdownLimitExceeded (1min)

# Warning Alerts
- HighOrderLatency (5min)
- CircuitBreakerOpen (1min)
- PositionSyncLost (10min)

ğŸ® TELEGRAM COMMANDS
ĞÑĞ½Ğ¾Ğ²Ğ½Ñ‹Ğµ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹

/help â€” ÑĞ¿Ğ¸ÑĞ¾Ğº Ğ²ÑĞµÑ… ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´
/status â€” ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹ Ğ¸ Ğ¿Ğ¾Ğ·Ğ¸Ñ†Ğ¸Ğ¹
/health â€” Ğ´ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ğ°Ñ Ğ´Ğ¸Ğ°Ğ³Ğ½Ğ¾ÑÑ‚Ğ¸ĞºĞ° ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹

Trading Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸

/eval [SYMBOL] [TF] [LIMIT] â€” ğŸ”¥ Ñ€Ğ°ÑÑ‡ĞµÑ‚ ÑĞ¸Ğ³Ğ½Ğ°Ğ»Ğ° Ğ±ĞµĞ· Ğ¸ÑĞ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ
/why [SYMBOL] [TF] [LIMIT] â€” ğŸ”¥ Ğ¾Ğ±ÑŠÑÑĞ½ĞµĞ½Ğ¸Ğµ Ñ‚Ğ¾Ñ€Ğ³Ğ¾Ğ²Ğ¾Ğ³Ğ¾ Ñ€ĞµÑˆĞµĞ½Ğ¸Ñ
/profit [SYMBOL] â€” PnL ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° Ğ¸ Ğ³Ñ€Ğ°Ñ„Ğ¸Ğº
/positions [SYMBOL] â€” Ğ¾Ñ‚ĞºÑ€Ñ‹Ñ‚Ñ‹Ğµ Ğ¿Ğ¾Ğ·Ğ¸Ñ†Ğ¸Ğ¸

ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³

/test â€” smoke test Ğ²ÑĞµÑ… ÑĞ¸ÑÑ‚ĞµĞ¼
/metrics â€” ĞºĞ»ÑÑ‡ĞµĞ²Ñ‹Ğµ Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸ ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹
/exits â€” ÑÑ‚Ğ°Ñ‚ÑƒÑ protective exits


âš™ï¸ ĞšĞĞĞ¤Ğ˜Ğ“Ğ£Ğ ĞĞ¦Ğ˜Ğ¯
ĞÑĞ½Ğ¾Ğ²Ğ½Ñ‹Ğµ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹
env# === TRADING SETUP ===
MODE=live                    # paper/live/backtest
ENABLE_TRADING=true         # Ğ“Ğ»Ğ°Ğ²Ğ½Ñ‹Ğ¹ Ğ²Ñ‹ĞºĞ»ÑÑ‡Ğ°Ñ‚ĞµĞ»ÑŒ
SYMBOL=BTC/USDT            # Ğ¢Ğ¾Ñ€Ğ³ÑƒĞµĞ¼Ğ°Ñ Ğ¿Ğ°Ñ€Ğ°
POSITION_SIZE_USD=100      # ğŸ”¥ Ğ Ğ°Ğ·Ğ¼ĞµÑ€ Ğ¿Ğ¾Ğ·Ğ¸Ñ†Ğ¸Ğ¸ Ğ² USD

# === GATE.IO SETUP ===  
EXCHANGE=gateio
GATEIO_API_KEY=your_key
GATEIO_API_SECRET=your_secret
GATEIO_SANDBOX=false       # true Ğ´Ğ»Ñ testnet

# === RISK MANAGEMENT ===
MAX_POSITIONS=3            # ğŸ”¥ ĞœĞ°ĞºÑĞ¸Ğ¼ÑƒĞ¼ Ğ¿Ğ¾Ğ·Ğ¸Ñ†Ğ¸Ğ¹
STOP_LOSS_PCT=2.0         # ğŸ”¥ Stop Loss %
TAKE_PROFIT_PCT=4.0       # ğŸ”¥ Take Profit %
MAX_DRAWDOWN_PCT=5.0      # ğŸ”¥ ĞœĞ°ĞºÑĞ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ°Ñ Ğ¿Ñ€Ğ¾ÑĞ°Ğ´ĞºĞ°
RISK_HOURS_UTC=08:00-22:00 # ğŸ”¥ Ğ¢Ğ¾Ñ€Ğ³Ğ¾Ğ²Ñ‹Ğµ Ñ‡Ğ°ÑÑ‹

# === RECONCILIATION ===
RECONCILE_INTERVAL_SEC=60   # ğŸ”¥ Ğ§Ğ°ÑÑ‚Ğ¾Ñ‚Ğ° ÑĞ²ĞµÑ€ĞºĞ¸
RECONCILE_LOOKBACK_HOURS=24 # ğŸ”¥ Ğ“Ğ»ÑƒĞ±Ğ¸Ğ½Ğ° Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ¸

# === PERFORMANCE ===
PERF_BUDGET_DECISION_P99_MS=5000   # ğŸ”¥ SLA Ñ€ĞµÑˆĞµĞ½Ğ¸Ğ¹
PERF_BUDGET_ORDER_P99_MS=3000      # ğŸ”¥ SLA Ğ¾Ñ€Ğ´ĞµÑ€Ğ¾Ğ²  
PERF_BUDGET_FLOW_P99_MS=8000       # ğŸ”¥ SLA Ğ¿Ğ¾Ğ»Ğ½Ğ¾Ğ³Ğ¾ Ñ†Ğ¸ĞºĞ»Ğ°
Production ÑĞµĞºÑ€ĞµÑ‚Ñ‹
env# === SECURITY ===
TELEGRAM_BOT_TOKEN=bot123:secret
TELEGRAM_WEBHOOK_SECRET=webhook_secret
ALERT_TELEGRAM_CHAT_ID=-100123456  # ğŸ”¥ Ğ”Ğ»Ñ alerts

# === STORAGE ===
DB_PATH=/data/bot.sqlite          # Production path
DB_BACKUP_INTERVAL_HOURS=6        # ğŸ”¥ Backup frequency

# === MONITORING ===
SENTRY_DSN=https://sentry.io/...  # ğŸ”¥ Error tracking
LOG_LEVEL=INFO                    # DEBUG/INFO/WARNING/ERROR

ğŸ§ª TESTING
Test suites
bash# Unit tests
pytest tests/unit/ -v

# Integration tests  
pytest tests/integration/ -v --timeout=30

# Architecture compliance
./scripts/check_architecture.sh

# Performance tests
pytest tests/performance/ -v -m "not slow"

# Full test suite
pytest -v --cov=crypto_ai_bot --cov-report=html
Pre-deployment checklist
bash# ğŸ”¥ ĞšĞ Ğ˜Ğ¢Ğ˜Ğ§ĞĞ Ğ¿ĞµÑ€ĞµĞ´ production
â–¡ ./scripts/smoke_test.sh passes  
â–¡ All /health endpoints return healthy
â–¡ Reconciliation service connects to Gate.io
â–¡ Protective exits can be created and triggered
â–¡ Rate limits are properly configured
â–¡ Graceful shutdown works within 30 seconds
â–¡ All alerts fire correctly in test environment