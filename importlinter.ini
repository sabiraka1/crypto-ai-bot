[importlinter]
root_package = crypto_ai_bot
include_external_packages = False
verbosity = 1

# --- LAYERS: основная архитектура ---
[contract:layers]
name = Layers enforce architecture
type = layers
layers =
    crypto_ai_bot.utils
    crypto_ai_bot.core.domain
    crypto_ai_bot.core.application
    crypto_ai_bot.core.infrastructure
    crypto_ai_bot.app
    crypto_ai_bot.cli

# --- DOMAIN isolation ---
[contract:domain_is_isolated]
name = Domain does not import upwards
type = forbidden
source_modules =
    crypto_ai_bot.core.domain
forbidden_modules =
    crypto_ai_bot.core.application
    crypto_ai_bot.core.infrastructure
    crypto_ai_bot.app
    crypto_ai_bot.cli

# --- APPLICATION не должен зависеть от app/cli ---
[contract:application_no_app_cli]
name = Application does not import app or cli layers
type = forbidden
source_modules =
    crypto_ai_bot.core.application
forbidden_modules =
    crypto_ai_bot.app
    crypto_ai_bot.cli

# --- INFRASTRUCTURE не должен зависеть от app/cli ---
[contract:infrastructure_no_app_cli]
name = Infrastructure does not import app or cli layers
type = forbidden
source_modules =
    crypto_ai_bot.core.infrastructure
forbidden_modules =
    crypto_ai_bot.app
    crypto_ai_bot.cli

# --- APP top-level independence ---
[contract:app_is_top]
name = App layer is top-most (nobody imports it)
type = independence
modules =
    crypto_ai_bot.app

# --- CLI top-level independence ---
[contract:cli_is_top]
name = CLI layer is top-most (nobody imports it)
type = independence
modules =
    crypto_ai_bot.cli

# --- UTILS restrictions ---
[contract:forbid_utils_upwards]
name = Utils must not import core/app/cli
type = forbidden
source_modules =
    crypto_ai_bot.utils
forbidden_modules =
    crypto_ai_bot.core.domain
    crypto_ai_bot.core.application
    crypto_ai_bot.core.infrastructure
    crypto_ai_bot.app
    crypto_ai_bot.cli