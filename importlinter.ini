[importlinter]
root_package = crypto_ai_bot

########################
# 1) Слои ядра (правильный порядок)
########################
[contract:layers_core]
name = Core layers (app depends on domain; infra depends on app; domain независим)
type = layers
layers =
    crypto_ai_bot.app
    crypto_ai_bot.core.infrastructure
    crypto_ai_bot.core.application
    crypto_ai_bot.core.domain

########################
# 2) Запрет application -> infrastructure (с временными исключениями)
########################
[contract:forbid_app_infra]
name = Application must not import Infrastructure (with exemptions)
type = forbidden
source_modules =
    crypto_ai_bot.core.application
forbidden_modules =
    crypto_ai_bot.core.infrastructure
exemptions =
    # Временные исключения до полной миграции:
    crypto_ai_bot.core.application.use_cases.partial_fills -> crypto_ai_bot.core.infrastructure.*
    crypto_ai_bot.core.application.reconciliation.* -> crypto_ai_bot.core.infrastructure.*
