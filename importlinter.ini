[importlinter]
root_package = crypto_ai_bot

# Высокий уровень: cli, app → core → utils
[contract:layers_high]
name = High-level layering
layers =
    crypto_ai_bot.cli
    crypto_ai_bot.app
    crypto_ai_bot.core
    crypto_ai_bot.utils

# Внутри core: domain → application → infrastructure
# domain: риск-логика, стратегии, сущности
# application: use_cases, orchestrator, reconciliation, monitoring
# infrastructure: brokers, storage, safety (DMS/locks), events (bus), settings
[contract:layers_core]
name = Core layering (domain->application->infrastructure)
layers =
    crypto_ai_bot.core.domain
    crypto_ai_bot.core.application
    crypto_ai_bot.core.infrastructure

# Запрет обратных импортов в core
[contract:forbid_core_to_upper]
name = core must not import cli/app
type = forbidden
source_modules =
    crypto_ai_bot.core
forbidden_modules =
    crypto_ai_bot.cli
    crypto_ai_bot.app

# utils — самый нижний слой
[contract:forbid_utils_to_upper]
name = utils must not import upper layers
type = forbidden
source_modules =
    crypto_ai_bot.utils
forbidden_modules =
    crypto_ai_bot.cli
    crypto_ai_bot.app
    crypto_ai_bot.core

# Нет циклов в core
[contract:no_cycles_core]
name = No import cycles in core
type = independence
modules =
    crypto_ai_bot.core
