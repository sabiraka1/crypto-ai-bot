[importlinter]
root_package = crypto_ai_bot
include_external_packages = True

[contract:layers_core]
name = Слои (utils → domain → application → infrastructure → app/cli)
type = layers
layers =
    crypto_ai_bot.utils
    crypto_ai_bot.core.domain
    crypto_ai_bot.core.application
    crypto_ai_bot.core.infrastructure
    crypto_ai_bot.app
    crypto_ai_bot.cli

[contract:forbid_app_in_core]
name = Core не видит app/cli
type = forbidden
source_modules = crypto_ai_bot.core
forbidden_modules =
    crypto_ai_bot.app
    crypto_ai_bot.cli

[contract:forbid_infra_in_application]
name = Application не импортирует Infrastructure
type = forbidden
source_modules = crypto_ai_bot.core.application
forbidden_modules = crypto_ai_bot.core.infrastructure

[contract:forbid_infra_in_domain]
name = Domain не импортирует Application/Infrastructure
type = forbidden
source_modules = crypto_ai_bot.core.domain
forbidden_modules =
    crypto_ai_bot.core.application
    crypto_ai_bot.core.infrastructure

[contract:forbid_http_clients_in_core]
name = HTTP-клиенты не в core
type = forbidden
source_modules = crypto_ai_bot.core
forbidden_modules =
    httpx
    aiohttp
    requests

[contract:forbid_db_drivers_in_domain_application]
name = Драйверы БД не в domain/application
type = forbidden
source_modules =
    crypto_ai_bot.core.domain
    crypto_ai_bot.core.application
forbidden_modules =
    sqlite3
    aiosqlite

[contract:forbid_env_in_domain_application]
name = ENV запрещён в domain/application
type = forbidden
source_modules =
    crypto_ai_bot.core.domain
    crypto_ai_bot.core.application
forbidden_modules = os
