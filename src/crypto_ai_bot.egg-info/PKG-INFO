Metadata-Version: 2.4
Name: crypto-ai-bot
Version: 0.1.0
Summary: Production-ready ASGI trading bot (Gate.io via CCXT), long-only, paper/live parity, protective exits, reconciliation, observability
Author: Sabir Sahbaz
License: MIT
Requires-Python: >=3.11
Description-Content-Type: text/markdown
Requires-Dist: fastapi<1.0,>=0.115
Requires-Dist: uvicorn[standard]<0.31,>=0.30
Requires-Dist: gunicorn<22,>=21.2
Requires-Dist: httpx<0.28,>=0.27
Requires-Dist: ccxt<5,>=4.2
Requires-Dist: prometheus-client<0.21,>=0.20
Requires-Dist: pydantic<3,>=2.7
Requires-Dist: requests<3,>=2.31
Provides-Extra: charts
Requires-Dist: matplotlib<3.10,>=3.8; extra == "charts"
Provides-Extra: backtest
Requires-Dist: numpy<2.0,>=1.26; extra == "backtest"
Requires-Dist: pandas<3.0,>=2.2; extra == "backtest"
Provides-Extra: dev
Requires-Dist: pytest<9,>=8.2; extra == "dev"
Requires-Dist: pytest-asyncio<1,>=0.23; extra == "dev"
Requires-Dist: pytest-mock<4,>=3.12; extra == "dev"
Requires-Dist: coverage<8,>=7.4; extra == "dev"
Requires-Dist: ruff<0.7,>=0.6; extra == "dev"
Requires-Dist: pre-commit<4,>=3.6; extra == "dev"
Requires-Dist: mypy<2,>=1.8; extra == "dev"
Requires-Dist: import-linter<3,>=2.0; extra == "dev"
Requires-Dist: black<25,>=24.0; extra == "dev"
Requires-Dist: isort<6,>=5.13; extra == "dev"

crypto-ai-bot



ĞĞ²Ñ‚Ğ¾Ñ‚Ñ€ĞµĞ¹Ğ´Ğ¸Ğ½Ğ³ ĞºÑ€Ğ¸Ğ¿Ñ‚Ğ¾Ğ²Ğ°Ğ»ÑÑ‚ (Gate.io Ñ‡ĞµÑ€ĞµĞ· CCXT) Ñ ĞµĞ´Ğ¸Ğ½Ğ¾Ğ¹ Ğ»Ğ¾Ğ³Ğ¸ĞºĞ¾Ğ¹ Ğ´Ğ»Ñ paper Ğ¸ live:

strategies â†’ regime filter â†’ risk/limits â†’ execute\_trade â†’ protective\_exits â†’ reconcile â†’ watchdog â†’ settlement.



Ğ§Ğ¸ÑÑ‚Ğ°Ñ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°: ÑÑ‚Ñ€Ğ¾Ğ³Ğ¸Ğµ Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ†Ñ‹ app / core (application â†’ domain â†’ infrastructure) / utils Ğ¸ ĞºĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»ÑŒ Ğ¸Ğ¼Ğ¿Ğ¾Ñ€Ñ‚Ğ¾Ğ².

Ğ‘ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚ÑŒ Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ: Ğ¸Ğ´ĞµĞ¼Ğ¿Ğ¾Ñ‚ĞµĞ½Ñ‚Ğ½Ğ¾ÑÑ‚ÑŒ, Ğ»Ğ¸Ğ¼Ğ¸Ñ‚Ñ‹ Ñ€Ğ¸ÑĞºĞ°, Ğ·Ğ°Ñ‰Ğ¸Ñ‚Ğ½Ñ‹Ğµ Ğ²Ñ‹Ñ…Ğ¾Ğ´Ñ‹, DMS/InstanceLock, throttle Ğ±Ñ€Ğ¾ĞºĞµÑ€Ğ°.

ĞĞ°Ğ±Ğ»ÑĞ´Ğ°ĞµĞ¼Ğ¾ÑÑ‚ÑŒ: Prometheus-Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸, health/ready, Telegram (Ğ°Ğ»ĞµÑ€Ñ‚Ñ‹ Ğ¸ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹), Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Alertmanager.

Ğ’Ğ¾ÑÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ: ÑĞ²ĞµÑ€ĞºĞ¸ Ğ¸ Ğ´Ğ¾Ğ²ĞµĞ´ĞµĞ½Ğ¸Ğµ Ñ‡Ğ°ÑÑ‚Ğ¸Ñ‡Ğ½Ñ‹Ñ… Ğ¸ÑĞ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ğ¹ (settlement) Ñ Ğ·Ğ°Ğ¿Ğ¸ÑÑŒÑ Ğ² Ğ‘Ğ”.



ğŸ“¦ Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Ğ¸ Ğ·Ğ°Ğ¿ÑƒÑĞº



1\) ĞĞºÑ€ÑƒĞ¶ĞµĞ½Ğ¸Ğµ



python -m venv .venv

\# Windows

.\\.venv\\Scripts\\Activate.ps1

\# Linux/macOS

source .venv/bin/activate



pip install -U pip wheel

pip install -e .





2\) ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ



Ğ¡ĞºĞ¾Ğ¿Ğ¸Ñ€ÑƒĞ¹Ñ‚Ğµ .env.example â†’ .env Ğ¸ Ğ·Ğ°Ğ´Ğ°Ğ¹Ñ‚Ğµ Ğ¿ĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ.

Ğ¡ĞµĞºÑ€ĞµÑ‚Ñ‹ Ğ¿Ğ¾Ğ´Ğ´ĞµÑ€Ğ¶Ğ¸Ğ²Ğ°ÑÑ‚ÑÑ Ğ² Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğ°Ñ…: NAME\_FILE (Ğ¿ÑƒÑ‚ÑŒ Ğº Ñ„Ğ°Ğ¹Ğ»Ñƒ), NAME\_B64 (base64), Ğ¸Ğ»Ğ¸ ĞµĞ´Ğ¸Ğ½Ñ‹Ğ¹ SECRETS\_FILE (JSON).



3\) API (Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ¾)



uvicorn crypto\_ai\_bot.app.server:app --host 0.0.0.0 --port 8000





4\) CLI (ÑĞµÑ€Ğ²Ğ¸ÑĞ½Ñ‹Ğµ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹)



\# Ğ‘Ñ‹ÑÑ‚Ñ€Ñ‹Ğ¹ smoke-Ñ‡ĞµĞº

cab-smoke



\# Ğ‘Ğ”: Ğ±ÑĞºĞ°Ğ¿/Ñ€Ğ¾Ñ‚Ğ°Ñ†Ğ¸Ñ/Ğ²Ğ°ĞºÑƒÑƒĞ¼/Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ¸Ñ‚Ğ¸/ÑĞ¿Ğ¸ÑĞ¾Ğº

cab-maintenance backup

cab-maintenance rotate --days 30

cab-maintenance vacuum

cab-maintenance integrity

cab-maintenance list



\# Ğ¡Ğ²ĞµÑ€ĞºĞ¸ (Ğ±Ğ°Ğ»Ğ°Ğ½ÑÑ‹/Ğ¿Ğ¾Ğ·Ğ¸Ñ†Ğ¸Ğ¸)

cab-reconcile



\# ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ health (ĞºĞ¾Ğ³Ğ´Ğ° API Ğ·Ğ°Ğ¿ÑƒÑ‰ĞµĞ½)

cab-health-monitor --oneshot --url http://127.0.0.1:8000/health



\# ĞÑ‚Ñ‡Ñ‘Ñ‚ Ğ¿Ğ¾ ÑĞ´ĞµĞ»ĞºĞ°Ğ¼/PNL (FIFO) Ğ·Ğ° ÑĞµĞ³Ğ¾Ğ´Ğ½Ñ

cab-perf



ğŸ”Œ HTTP-ÑĞ½Ğ´Ğ¿Ğ¾Ğ¸Ğ½Ñ‚Ñ‹



GET /health â€” Ñ‚ĞµĞºÑƒÑ‰ĞµĞµ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ (Ğ‘Ğ”/ÑˆĞ¸Ğ½Ğ°/Ğ±Ğ¸Ñ€Ğ¶Ğ°).



GET /ready â€” Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ğ½Ğ¾ÑÑ‚ÑŒ (200/503).



GET /metrics â€” Prometheus.



GET /orchestrator/status?symbol=BTC/USDT â€” ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ Ğ¾Ñ€ĞºĞµÑÑ‚Ñ€Ğ°Ñ‚Ğ¾Ñ€Ğ°.



POST /orchestrator/(start|stop|pause|resume)?symbol=... â€” ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ (Bearer API\_TOKEN).



GET /pnl/today?symbol=... â€” PnL Ğ·Ğ° ÑĞµĞ³Ğ¾Ğ´Ğ½Ñ (FIFO) + Ğ¾Ğ±Ğ¾Ñ€Ğ¾Ñ‚ Ğ¸ ÑÑ‡ĞµÑ‚Ñ‡Ğ¸Ğº Ğ¾Ñ€Ğ´ĞµÑ€Ğ¾Ğ². Ğ˜ÑÑ‚Ğ¾Ñ‡Ğ½Ğ¸Ğº Ğ¸ÑÑ‚Ğ¸Ğ½Ñ‹: storage.trades (daily\_pnl\_quote, daily\_turnover\_quote, count\_orders\_today), Ğ±ĞµĞ· Ğ·Ğ°Ğ¿Ğ°ÑĞ½Ñ‹Ñ… Ğ¾Ğ±Ñ…Ğ¾Ğ´Ğ¾Ğ².



ğŸ¤– Telegram (Ğ¼Ğ½Ğ¾Ğ³Ğ¾ÑƒÑ€Ğ¾Ğ²Ğ½ĞµĞ²Ğ°Ñ Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ)



Ğ Ğ°Ğ·Ğ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ğ¾Ğ±ÑĞ·Ğ°Ğ½Ğ½Ğ¾ÑÑ‚ĞµĞ¹ (Ğ±ĞµĞ· Ğ´ÑƒĞ±Ğ»ĞµĞ¹):



app/telegram.py â€” publisher: Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ¸ÑÑ…Ğ¾Ğ´ÑÑ‰Ğ¸Ğµ Ğ°Ğ»ĞµÑ€Ñ‚Ñ‹ (Ñ€ĞµÑ‚Ñ€Ğ°Ğ¸, HTML, Ğ´ĞµĞ´ÑƒĞ¿/Ğ°Ğ½Ñ‚Ğ¸ÑˆÑ‚Ğ¾Ñ€Ğ¼).



app/telegram\_bot.py â€” operator bot: Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ²Ñ…Ğ¾Ğ´ÑÑ‰Ğ¸Ğµ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹ (whitelist/roles).



app/telegram\_alerts.py â€” Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑÑ‡Ğ¸Ğº EventBus â†’ Telegram (Ğ² Ñ‚.Ñ‡. Alertmanager Ğ²ĞµĞ±Ñ…ÑƒĞºĞ¸).



ĞšĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹ Ğ±Ğ¾Ñ‚Ğ° (Ğ¾ÑĞ½Ğ¾Ğ²Ğ½Ñ‹Ğµ):

/status, /today, /pnl, /position, /balance, /limits, /pause, /resume, /stop, /health.



Alertmanager â†’ /alertmanager/webhook â†’ EventBus â†’ app/telegram\_alerts.py â†’ Telegram.

Ğ•ÑĞ»Ğ¸ TELEGRAM\_\* Ğ½Ğµ Ğ·Ğ°Ğ´Ğ°Ğ½Ñ‹ â€” Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ğ¸ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ÑÑ‚ Ğ² no-op (Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾).



ğŸ§± ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° Ğ¸ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»Ğ° ÑĞ»Ğ¾Ñ‘Ğ²



Ğ¡Ğ»Ğ¾Ğ¸ Ğ¸ Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸



app/ â€” HTTP API (FastAPI), DI/compose, Telegram Ğ°Ğ´Ğ°Ğ¿Ñ‚ĞµÑ€Ñ‹/Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑÑ‡Ğ¸ĞºĞ¸.

ĞœĞ¾Ğ¶ĞµÑ‚ Ğ¸Ğ¼Ğ¿Ğ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ: core.application, core.infrastructure, utils.



core/application/ â€” Ğ¾Ñ€ĞºĞµÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ, use-cases, protective exits, reconciliation, monitoring, Ñ€ĞµĞµÑÑ‚Ñ€ Ñ‚ĞµĞ¼ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğ¹.

ĞœĞ¾Ğ¶ĞµÑ‚ Ğ¸Ğ¼Ğ¿Ğ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ: core.domain, utils. ĞĞµ Ğ¼Ğ¾Ğ¶ĞµÑ‚: app, core.infrastructure.



core/domain/ â€” Ñ‡Ğ¸ÑÑ‚Ñ‹Ğµ Ğ±Ğ¸Ğ·Ğ½ĞµÑ-Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»Ğ° (risk, ÑÑ‚Ñ€Ğ°Ñ‚ĞµĞ³Ğ¸Ğ¸, ÑĞ¸Ğ³Ğ½Ğ°Ğ»Ñ‹, Ñ€ĞµĞ¶Ğ¸Ğ¼Ñ‹).

ĞœĞ¾Ğ¶ĞµÑ‚ Ğ¸Ğ¼Ğ¿Ğ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ: utils. ĞĞµ Ğ¼Ğ¾Ğ¶ĞµÑ‚: app, core.application, core.infrastructure.



core/infrastructure/ â€” Ğ±Ñ€Ğ¾ĞºĞµÑ€Ñ‹ (CCXT/Paper), ÑˆĞ¸Ğ½Ğ° (Redis/in-mem), storage (SQLite+Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ğ¸), safety (DMS/lock), settings.

ĞœĞ¾Ğ¶ĞµÑ‚ Ğ¸Ğ¼Ğ¿Ğ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ: utils. ĞĞµ Ğ¼Ğ¾Ğ¶ĞµÑ‚: app, core.application, core.domain.



utils/ â€” Ğ¾Ğ±Ñ‰Ğ¸Ğµ ÑƒÑ‚Ğ¸Ğ»Ğ¸Ñ‚Ñ‹ (Decimal, Ğ»Ğ¾Ğ³Ğ¸, Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸, retry, http, pnl, trace, symbols).



ĞšĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»ÑŒ ÑĞ»Ğ¾Ñ‘Ğ²: importlinter.ini (CI Ğ¿Ğ°Ğ´Ğ°ĞµÑ‚ Ğ¿Ñ€Ğ¸ Ğ½Ğ°Ñ€ÑƒÑˆĞµĞ½Ğ¸Ğ¸).



Ğ˜Ğ½Ğ²Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚Ñ‹ (Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Ğ¿Ñ€Ğ¸ ÑÑ‚Ğ°Ñ€Ñ‚Ğµ)



RiskManager Ğ½Ğµ Ğ¿ÑƒĞ±Ğ»Ğ¸ĞºÑƒĞµÑ‚ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ Ğ¸ Ğ½Ğµ Ñ…Ğ¾Ğ´Ğ¸Ñ‚ Ğ²Ğ¾ Ğ²Ğ½ĞµÑˆĞ½Ğ¸Ğµ ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹; Ğ¾Ğ½ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ (ok, reason\[, extra]). ĞŸÑƒĞ±Ğ»Ğ¸ĞºĞ°Ñ†Ğ¸Ñ RISK\_\* ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğ¹ â€” Ğ² orchestrator/use-cases.



Ğ‘Ğ°Ğ»Ğ°Ğ½Ñ Ğ±Ñ€Ğ¾ĞºĞµÑ€Ğ°: ĞºĞ¾Ğ½Ñ‚Ñ€Ğ°ĞºÑ‚ BrokerPort.fetch\_balance(symbol) -> dict\[str, Decimal] c ĞºĞ»ÑÑ‡Ğ°Ğ¼Ğ¸ free\_base, free\_quote (Ğ½Ğ¸ĞºĞ°ĞºĞ¸Ñ… DTO).



InstanceLock: Ğ·Ğ°Ñ…Ğ²Ğ°Ñ‚Ñ‹Ğ²Ğ°ĞµÑ‚ÑÑ Ğ½Ğ° ÑÑ‚Ğ°Ñ€Ñ‚Ğµ, Ğ¾ÑĞ²Ğ¾Ğ±Ğ¾Ğ¶Ğ´Ğ°ĞµÑ‚ÑÑ Ğ¿Ñ€Ğ¸ shutdown (graceful).



MTF weights: 15m=0.40, 1h=0.25, 4h=0.20, 1d=0.10, 1w=0.05 (ÑÑƒĞ¼Ğ¼Ğ° = 1.0).



Fusion weights: technical=0.65, ai=0.35 (ÑÑƒĞ¼Ğ¼Ğ° = 1.0).



Settings Ñ‡Ğ¸Ñ‚Ğ°ÑÑ‚ÑÑ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ñ‡ĞµÑ€ĞµĞ· core/infrastructure/settings.py.



Ğ”ĞµĞ½ÑŒĞ³Ğ¸ â€” Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Decimal (utils.decimal.dec()).



ĞÑĞ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ñ‰Ğ¸Ğ½Ğ° Ğ±ĞµĞ· time.sleep (Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ asyncio.sleep).



Ğ¢ĞµĞ¼Ñ‹ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğ¹ â€” Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ ĞºĞ¾Ğ½ÑÑ‚Ğ°Ğ½Ñ‚Ñ‹ core/application/events\_topics.py (Ğ½Ğ¸ĞºĞ°ĞºĞ¸Ñ… Â«Ğ¼Ğ°Ğ³Ğ¸Ñ‡ĞµÑĞºĞ¸Ñ… ÑÑ‚Ñ€Ğ¾ĞºÂ»).



EventBus auto-detect: EVENT\_BUS\_URL c redis://â€¦ â†’ RedisEventBus, Ğ¿ÑƒÑÑ‚Ğ¾ â†’ AsyncEventBus (in-memory).



ğŸ—‚ï¸ ĞĞºÑ‚ÑƒĞ°Ğ»ÑŒĞ½Ğ°Ñ Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ²Ğ°Ñ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ°



Ğ’Ğ°Ğ¶Ğ½Ğ¾: Ğ¿Ğ°Ğ¿ĞºĞ° ops/prometheus/ (Prometheus/Alertmanager/Grafana) ÑƒĞ¶Ğµ Ñ€Ğ°Ğ·Ğ²ĞµÑ€Ğ½ÑƒÑ‚Ğ° Ğ½Ğ° Railway Ğ¸ Ğ¸Ğ· Ñ€ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ñ Ğ¸ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ° â€” Ğ¼Ñ‹ Ğ¾ÑÑ‚Ğ°Ğ²Ğ¸Ğ»Ğ¸ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‡Ğ¸Ğº Ğ²ĞµĞ±Ñ…ÑƒĞºĞ° Alertmanager Ğ² Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğ¸. Ğ­Ñ‚Ğ¾ ÑĞ½Ğ¸Ğ¶Ğ°ĞµÑ‚ ÑˆÑƒĞ¼ Ğ² Ñ€ĞµĞ¿Ğ¾ Ğ¸ Ğ¿Ğ¾Ğ´Ğ´ĞµÑ€Ğ¶Ğ¸Ğ²Ğ°ĞµÑ‚ Â«Ğ¸Ğ½Ñ„Ñ€Ñƒ ĞºĞ°Ğº Ğ²Ğ½ĞµÑˆĞ½Ğ¸Ğ¹ ÑĞµÑ€Ğ²Ğ¸ÑÂ».



crypto-ai-bot/

â”œâ”€ README.md

â”œâ”€ pyproject.toml

â”œâ”€ requirements\*.txt

â”œâ”€ Makefile

â”œâ”€ Procfile

â”œâ”€ .gitignore

â”œâ”€ pytest.ini

â”œâ”€ importlinter.ini

â”œâ”€ scripts/

â”‚  â”œâ”€ backup\_db.py

â”‚  â”œâ”€ rotate\_backups.py

â”‚  â”œâ”€ integrity\_check.py

â”‚  â”œâ”€ run\_server.sh

â”‚  â””â”€ run\_server.ps1

â””â”€ src/crypto\_ai\_bot/

&nbsp;  â”œâ”€ app/

&nbsp;  â”‚  â”œâ”€ server.py                 # ğŸŒ FastAPI (health/metrics/pnl/orchestrator/telegram webhook)

&nbsp;  â”‚  â”œâ”€ compose.py                # ğŸ”Œ DI-ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½Ğ¾Ğ²ĞºĞ° (broker/storage/bus/health/lock/Ğ¾Ñ€ĞºĞµÑÑ‚Ñ€Ğ°Ñ‚Ğ¾Ñ€Ñ‹)

&nbsp;  â”‚  â”œâ”€ logging\_bootstrap.py      # ğŸ§¾ Ğ˜Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ½Ğ¾Ğ³Ğ¾ Ğ»Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ

&nbsp;  â”‚  â”œâ”€ http\_dxy.py               # ğŸŒ DXY HTTP-Ğ¸ÑÑ‚Ğ¾Ñ‡Ğ½Ğ¸Ğº (change\_pct)

&nbsp;  â”‚  â”œâ”€ http\_btc\_dominance.py     # ğŸŒ BTC Dominance HTTP-Ğ¸ÑÑ‚Ğ¾Ñ‡Ğ½Ğ¸Ğº (change\_pct)

&nbsp;  â”‚  â”œâ”€ http\_fomc.py              # ğŸŒ FOMC HTTP-Ğ¸ÑÑ‚Ğ¾Ñ‡Ğ½Ğ¸Ğº (event\_today)

&nbsp;  â”‚  â”œâ”€ telegram.py               # ğŸ“£ Telegram publisher (Ğ¸ÑÑ…Ğ¾Ğ´ÑÑ‰Ğ¸Ğµ Ğ°Ğ»ĞµÑ€Ñ‚Ñ‹)

&nbsp;  â”‚  â”œâ”€ telegram\_bot.py           # ğŸ¤– Telegram bot (Ğ²Ñ…Ğ¾Ğ´ÑÑ‰Ğ¸Ğµ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹ /status|/pause|/resume)

&nbsp;  â”‚  â””â”€ telegram\_alerts.py        # ğŸ”” Alertmanagerâ†’EventBusâ†’Telegram (Ğ¼Ğ°Ñ€ÑˆÑ€ÑƒÑ‚Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ°Ğ»ĞµÑ€Ñ‚Ğ¾Ğ²)

&nbsp;  â”œâ”€ cli/

&nbsp;  â”‚  â”œâ”€ smoke.py

&nbsp;  â”‚  â”œâ”€ maintenance.py

&nbsp;  â”‚  â”œâ”€ reconcile.py

&nbsp;  â”‚  â”œâ”€ performance.py

&nbsp;  â”‚  â””â”€ health\_monitor.py

&nbsp;  â”œâ”€ core/

&nbsp;  â”‚  â”œâ”€ application/

&nbsp;  â”‚  â”‚  â”œâ”€ orchestrator.py

&nbsp;  â”‚  â”‚  â”œâ”€ ports.py

&nbsp;  â”‚  â”‚  â”œâ”€ events\_topics.py       # â† ĞµĞ´Ğ¸Ğ½Ñ‹Ğ¹ Ñ€ĞµĞµÑÑ‚Ñ€ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğ¹

&nbsp;  â”‚  â”‚  â”œâ”€ protective\_exits.py

&nbsp;  â”‚  â”‚  â”œâ”€ use\_cases/

&nbsp;  â”‚  â”‚  â”‚  â”œâ”€ eval\_and\_execute.py

&nbsp;  â”‚  â”‚  â”‚  â”œâ”€ execute\_trade.py    # â† ĞµĞ´Ğ¸Ğ½ÑÑ‚Ğ²ĞµĞ½Ğ½Ğ°Ñ Ñ‚Ğ¾Ñ‡ĞºĞ° Ñ€Ğ°Ğ·Ğ¼ĞµÑ‰ĞµĞ½Ğ¸Ñ Ğ¾Ñ€Ğ´ĞµÑ€Ğ¾Ğ²

&nbsp;  â”‚  â”‚  â”‚  â””â”€ partial\_fills.py    # settlement/Ğ´Ğ¾Ğ²ĞµĞ´ĞµĞ½Ğ¸Ğµ Ñ‡Ğ°ÑÑ‚Ğ¸Ñ‡Ğ½Ñ‹Ñ…

&nbsp;  â”‚  â”‚  â”œâ”€ reconciliation/

&nbsp;  â”‚  â”‚  â”‚  â”œâ”€ orders.py

&nbsp;  â”‚  â”‚  â”‚  â”œâ”€ positions.py

&nbsp;  â”‚  â”‚  â”‚  â””â”€ balances.py

&nbsp;  â”‚  â”‚  â”œâ”€ regime/

&nbsp;  â”‚  â”‚  â”‚  â””â”€ gated\_broker.py

&nbsp;  â”‚  â”‚  â””â”€ monitoring/

&nbsp;  â”‚  â”‚     â””â”€ health\_checker.py

&nbsp;  â”‚  â”œâ”€ domain/

&nbsp;  â”‚  â”‚  â”œâ”€ risk/

&nbsp;  â”‚  â”‚  â”‚  â”œâ”€ manager.py

&nbsp;  â”‚  â”‚  â”‚  â””â”€ rules/

&nbsp;  â”‚  â”‚  â”‚     â”œâ”€ loss\_streak.py

&nbsp;  â”‚  â”‚  â”‚     â”œâ”€ max\_drawdown.py

&nbsp;  â”‚  â”‚  â”‚     â”œâ”€ max\_orders\_5m.py

&nbsp;  â”‚  â”‚  â”‚     â”œâ”€ max\_turnover\_5m.py

&nbsp;  â”‚  â”‚  â”‚     â”œâ”€ cooldown.py

&nbsp;  â”‚  â”‚  â”‚     â”œâ”€ daily\_loss.py

&nbsp;  â”‚  â”‚  â”‚     â”œâ”€ spread\_cap.py

&nbsp;  â”‚  â”‚  â”‚     â””â”€ correlation\_manager.py

&nbsp;  â”‚  â”‚  â”œâ”€ strategies/ ...        # (EMA/RSI/Bollinger/ATR/â€¦)

&nbsp;  â”‚  â”‚  â”œâ”€ signals/

&nbsp;  â”‚  â”‚  â”‚  â”œâ”€ timeframes.py

&nbsp;  â”‚  â”‚  â”‚  â”œâ”€ fusion.py

&nbsp;  â”‚  â”‚  â”‚  â”œâ”€ ai\_model.py

&nbsp;  â”‚  â”‚  â”‚  â”œâ”€ ai\_scoring.py

&nbsp;  â”‚  â”‚  â”‚  â””â”€ feature\_pipeline.py

&nbsp;  â”‚  â”‚  â””â”€ macro/

&nbsp;  â”‚  â”‚     â”œâ”€ regime\_detector.py

&nbsp;  â”‚  â”‚     â””â”€ types.py

&nbsp;  â”‚  â””â”€ infrastructure/

&nbsp;  â”‚     â”œâ”€ settings.py

&nbsp;  â”‚     â”œâ”€ settings\_schema.py

&nbsp;  â”‚     â”œâ”€ brokers/

&nbsp;  â”‚     â”‚  â”œâ”€ base.py

&nbsp;  â”‚     â”‚  â”œâ”€ factory.py

&nbsp;  â”‚     â”‚  â”œâ”€ ccxt\_adapter.py

&nbsp;  â”‚     â”‚  â”œâ”€ live.py

&nbsp;  â”‚     â”‚  â””â”€ paper.py

&nbsp;  â”‚     â”œâ”€ events/

&nbsp;  â”‚     â”‚  â”œâ”€ bus.py

&nbsp;  â”‚     â”‚  â”œâ”€ bus\_adapter.py

&nbsp;  â”‚     â”‚  â””â”€ redis\_bus.py

&nbsp;  â”‚     â”œâ”€ safety/

&nbsp;  â”‚     â”‚  â”œâ”€ dead\_mans\_switch.py

&nbsp;  â”‚     â”‚  â””â”€ instance\_lock.py

&nbsp;  â”‚     â”œâ”€ storage/

&nbsp;  â”‚     â”‚  â”œâ”€ facade.py

&nbsp;  â”‚     â”‚  â”œâ”€ sqlite\_adapter.py

&nbsp;  â”‚     â”‚  â”œâ”€ backup.py

&nbsp;  â”‚     â”‚  â””â”€ migrations/

&nbsp;  â”‚     â”‚     â”œâ”€ runner.py

&nbsp;  â”‚     â”‚     â”œâ”€ V0001\_\_init.sql

&nbsp;  â”‚     â”‚     â”œâ”€ V0006\_\_trades\_indexes.sql

&nbsp;  â”‚     â”‚     â”œâ”€ V0007\_\_idempotency\_unique\_and\_ts.sql

&nbsp;  â”‚     â”‚     â”œâ”€ V0008\_\_positions\_idx.sql

&nbsp;  â”‚     â”‚     â”œâ”€ V0009\_\_trades\_unique\_ids.sql

&nbsp;  â”‚     â”‚     â”œâ”€ V0010\_\_audit\_ts\_idx.sql

&nbsp;  â”‚     â”‚     â””â”€ V0012\_\_orders\_table.sql

&nbsp;  â””â”€ utils/

&nbsp;     â”œâ”€ decimal.py

&nbsp;     â”œâ”€ pnl.py

&nbsp;     â”œâ”€ metrics.py

&nbsp;     â”œâ”€ logging.py

&nbsp;     â”œâ”€ retry.py

&nbsp;     â”œâ”€ http\_client.py

&nbsp;     â”œâ”€ symbols.py

&nbsp;     â”œâ”€ time.py

&nbsp;     â””â”€ trace.py





ĞŸÑ€Ğ¸Ğ¼ĞµÑ‡Ğ°Ğ½Ğ¸Ğµ: place\_order.py Ğ¸ÑÑ‚Ğ¾Ñ€Ğ¸Ñ‡ĞµÑĞºĞ¸ ÑÑƒÑ‰ĞµÑÑ‚Ğ²Ğ¾Ğ²Ğ°Ğ» ĞºĞ°Ğº Ğ¼Ğ¾ÑÑ‚Ğ¸Ğº â€” Ñ‚ĞµĞ¿ĞµÑ€ÑŒ Ğ²ÑÑ Ğ¿Ğ¾ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Ğ¾Ñ€Ğ´ĞµÑ€Ğ¾Ğ² Ğ¸Ğ´Ñ‘Ñ‚ Ñ‡ĞµÑ€ĞµĞ· execute\_trade.py. Ğ•ÑĞ»Ğ¸ Ğ½ĞµÑ‚ Ğ²Ğ½ĞµÑˆĞ½Ğ¸Ñ… Ğ¸Ğ¼Ğ¿Ğ¾Ñ€Ñ‚Ğ¾Ğ² Ğ½Ğ° place\_order.py, Ñ„Ğ°Ğ¹Ğ» Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ ÑƒĞ±Ñ€Ğ°Ñ‚ÑŒ.



ğŸ”„ Ğ¢Ğ¾Ñ€Ğ³Ğ¾Ğ²Ñ‹Ğ¹ ĞºĞ¾Ğ½Ğ²ĞµĞ¹ĞµÑ€ (ÑĞ¸Ğ³Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¿Ğ°Ğ¹Ğ¿Ğ»Ğ°Ğ¹Ğ½)



Multi-Timeframe Analysis (signals/timeframes.py)

15m=40% Â· 1h=25% Â· 4h=20% Â· 1d=10% Â· 1w=5% (Ğ¸Ğ½Ğ²Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚, Ñ„Ğ¸ĞºÑĞ¸Ñ€ÑƒĞµÑ‚ÑÑ Ğ² settings\_schema.py)



Signal Fusion (signals/fusion.py)

Technical=65% Â· AI=35% (Ğ¸Ğ½Ğ²Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚)



Strategy Aggregation (strategies/strategy\_manager.py)

first | vote | weighted



Regime Filtering (application/regime/gated\_broker.py)

Ğ˜ÑÑ‚Ğ¾Ñ‡Ğ½Ğ¸ĞºĞ¸: DXY, BTC dominance, FOMC. risk\_off Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€ÑƒĞµÑ‚ Ğ½Ğ¾Ğ²Ñ‹Ğµ Ğ²Ñ…Ğ¾Ğ´Ñ‹/ÑÑƒĞ¶Ğ°ĞµÑ‚ Ğ¾Ğ±ÑŠÑ‘Ğ¼.



Risk Management (domain/risk/)

LossStreak, MaxDrawdown, MaxOrders5m, MaxTurnover5m, Cooldown, DailyLoss, SpreadCap, Anti-Correlation.



Execute (use\_cases/execute\_trade.py) â€” ĞµĞ´Ğ¸Ğ½Ğ°Ñ Ñ‚Ğ¾Ñ‡ĞºĞ° Ğ¸ÑĞ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ + Ğ¸Ğ´ĞµĞ¼Ğ¿Ğ¾Ñ‚ĞµĞ½Ñ‚Ğ½Ğ¾ÑÑ‚ÑŒ.

Protective Exits (protective\_exits.py) â€” hard/trailing ÑÑ‚Ğ¾Ğ¿Ñ‹.

Reconcile (reconciliation/\*) â€” Ğ¿Ğ¾Ğ·Ğ¸Ñ†Ğ¸Ğ¸/Ğ±Ğ°Ğ»Ğ°Ğ½ÑÑ‹.

Watchdog (monitoring/health\_checker.py) â€” health/DMS.

Settlement (use\_cases/partial\_fills.py) â€” Ğ´Ğ¾Ğ²ĞµĞ´ĞµĞ½Ğ¸Ğµ Ñ‡Ğ°ÑÑ‚Ğ¸Ñ‡Ğ½Ğ¾ Ğ¸ÑĞ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ½Ñ‹Ñ… Ğ¾Ñ€Ğ´ĞµÑ€Ğ¾Ğ².



ğŸ›¡ï¸ Ğ‘ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚ÑŒ Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ



Ğ˜Ğ´ĞµĞ¼Ğ¿Ğ¾Ñ‚ĞµĞ½Ñ‚Ğ½Ğ¾ÑÑ‚ÑŒ: client\_order\_id + idempotency-Ñ€ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ¹ (TTL).



Ğ‘ÑĞ´Ğ¶ĞµÑ‚Ñ‹: Ğ´Ğ½ĞµĞ²Ğ½Ñ‹Ğµ Ğ»Ğ¸Ğ¼Ğ¸Ñ‚Ñ‹ ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ° Ğ¾Ñ€Ğ´ĞµÑ€Ğ¾Ğ² Ğ¸ Ğ¾Ğ±Ğ¾Ñ€Ğ¾Ñ‚Ğ° (quote).



ĞĞ½Ñ‚Ğ¸-Ğ±Ñ‘Ñ€ÑÑ‚: Ğ»Ğ¸Ğ¼Ğ¸Ñ‚Ñ‹ Ğ½Ğ° 5 Ğ¼Ğ¸Ğ½ÑƒÑ‚ (orders/turnover).



Cooldown: Ğ¼Ğ¸Ğ½Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¸Ğ½Ñ‚ĞµÑ€Ğ²Ğ°Ğ» Ğ¼ĞµĞ¶Ğ´Ñƒ ÑĞ´ĞµĞ»ĞºĞ°Ğ¼Ğ¸.



SpreadCap: Ğ·Ğ°Ğ¿Ñ€ĞµÑ‚ ÑĞ´ĞµĞ»Ğ¾Ğº Ğ¿Ñ€Ğ¸ Ğ·Ğ°Ğ²Ñ‹ÑˆĞµĞ½Ğ½Ğ¾Ğ¼ ÑĞ¿Ñ€ÑĞ´Ğµ.



DailyLoss: ÑÑ‚Ğ¾Ğ¿ Ğ¿Ğ¾ Ğ´Ğ½ĞµĞ²Ğ½Ğ¾Ğ¼Ñƒ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ¾Ğ¼Ñƒ ÑƒĞ±Ñ‹Ñ‚ĞºÑƒ (quote).



Anti-Correlation: Ğ·Ğ°Ğ¿Ñ€ĞµÑ‚ Ğ¾Ğ´Ğ½Ğ¾Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ñ… Ğ¿Ğ¾Ğ·Ğ¸Ñ†Ğ¸Ğ¹ Ğ² Ğ²Ñ‹ÑĞ¾ĞºĞ¾-ĞºĞ¾Ñ€Ñ€ĞµĞ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ³Ñ€ÑƒĞ¿Ğ¿Ğ°Ñ….



Throttle Ğ±Ñ€Ğ¾ĞºĞµÑ€Ğ°: BROKER\_RATE\_RPS/BURST.



DMS: Ğ·Ğ°Ñ‰Ğ¸Ñ‰Ñ‘Ğ½Ğ½Ğ°Ñ Ñ€Ğ°ÑĞ¿Ñ€Ğ¾Ğ´Ğ°Ğ¶Ğ° Ğ¿Ñ€Ğ¸ Ğ·Ğ°Ğ²Ğ¸ÑĞ°Ğ½Ğ¸ÑÑ….



Ğ¡ĞµĞºÑ€ĞµÑ‚Ñ‹: Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ñ‡ĞµÑ€ĞµĞ· \*\_FILE/\*\_B64/SECRETS\_FILE.



âš™ï¸ ENV (Ğ¾ÑĞ½Ğ¾Ğ²Ğ½Ñ‹Ğµ)



Ğ¢Ğ¾Ñ€Ğ³Ğ¾Ğ²Ğ»Ñ



MODE=paper|live

EXCHANGE=gateio

SYMBOLS=BTC/USDT,ETH/USDT

FIXED\_AMOUNT=50

PRICE\_FEED=fixed

FIXED\_PRICE=100





MTF / Fusion (Ğ¸Ğ½Ğ²Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚Ñ‹: ÑÑƒĞ¼Ğ¼Ğ° = 1.0)



MTF\_W\_M15=0.40

MTF\_W\_H1=0.25

MTF\_W\_H4=0.20

MTF\_W\_D1=0.10

MTF\_W\_W1=0.05



FUSION\_W\_TECHNICAL=0.65

FUSION\_W\_AI=0.35





Risk \& Safety



RISK\_COOLDOWN\_SEC=60

RISK\_MAX\_SPREAD\_PCT=0.30

RISK\_MAX\_SLIPPAGE\_PCT=0.10

RISK\_DAILY\_LOSS\_LIMIT\_QUOTE=100



RISK\_MAX\_ORDERS\_5M=0

RISK\_MAX\_TURNOVER\_5M\_QUOTE=0

SAFETY\_MAX\_ORDERS\_PER\_DAY=7

SAFETY\_MAX\_TURNOVER\_QUOTE\_PER\_DAY=5000





Regime



REGIME\_ENABLED=1

REGIME\_DXY\_URL=...

REGIME\_BTC\_DOM\_URL=...

REGIME\_FOMC\_URL=...

REGIME\_DXY\_LIMIT\_PCT=0.35

REGIME\_BTC\_DOM\_LIMIT\_PCT=0.60

REGIME\_FOMC\_BLOCK\_HOURS=8





Telegram



TELEGRAM\_ENABLED=1

TELEGRAM\_BOT\_TOKEN=...

TELEGRAM\_CHAT\_ID=...

TELEGRAM\_ALERTS\_CHAT\_ID=...

TELEGRAM\_BOT\_COMMANDS\_ENABLED=1

TELEGRAM\_ALLOWED\_USERS=123,456





Ğ˜Ğ½Ñ„Ñ€Ğ°ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ°



EVENT\_BUS\_URL=redis://redis:6379/0   # Ğ¿ÑƒÑÑ‚Ğ¾ = in-memory

DB\_PATH=./data/trader-gateio-BTCUSDT-paper.sqlite3

API\_TOKEN=...           # Ğ´Ğ»Ñ HTTP ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ

API\_KEY=...             # Gate.io live

API\_SECRET=...



ğŸ§ª Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¸ Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³



CLI: cab-smoke, cab-health-monitor, cab-perf, cab-reconcile.



Prometheus: /metrics + Alertmanager â†’ Telegram (Ñ‡ĞµÑ€ĞµĞ· app/telegram\_alerts.py).



Health/Ready: Ñ‡Ñ‘Ñ‚ĞºĞ¸Ğµ ÑÑ‚Ğ°Ñ‚ÑƒÑÑ‹ Ğ´Ğ»Ñ Ğ¾Ñ€ĞºĞµÑÑ‚Ñ€Ğ°Ñ‚Ğ¾Ñ€Ğ° Ğ¸ Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚ĞµĞ¹.



ğŸ” ĞšĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»ÑŒ ĞºĞ°Ñ‡ĞµÑÑ‚Ğ²Ğ° (Ñ‡Ñ‚Ğ¾ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼ Ñ€ĞµĞ³ÑƒĞ»ÑÑ€Ğ½Ğ¾)



Ğ‘Ğ¸Ğ·Ğ½ĞµÑ-Ñ†Ğ¸ĞºĞ»: Ñ†ĞµĞ¿Ğ¾Ñ‡ĞºĞ° evaluate â†’ risk â†’ execute\_trade â†’ protective\_exits â†’ reconcile â†’ watchdog â†’ settlement ÑĞ¾Ğ³Ğ»Ğ°ÑĞ¾Ğ²Ğ°Ğ½Ğ°.



PnL/FIFO/fees: Ğ²ĞµÑ€Ğ½Ñ‹Ğ¹ ÑƒÑ‡Ñ‘Ñ‚ ĞºĞ¾Ğ¼Ğ¸ÑÑĞ¸Ğ¹ (fee\_quote), ĞºĞ¾Ğ½ÑĞ¸ÑÑ‚ĞµĞ½Ñ‚Ğ½Ğ¾ÑÑ‚ÑŒ /pnl/today.



Risk: LossStreak, MaxDrawdown, Ğ»Ğ¸Ğ¼Ğ¸Ñ‚Ñ‹ 5m/day â€” ÑÑ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°ÑÑ‚ Ğ¸ Ğ»Ğ¾Ğ³Ğ¸Ñ€ÑƒÑÑ‚ÑÑ.



Graceful shutdown: ĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ğ¾ Ğ·Ğ°ĞºÑ€Ñ‹Ğ²Ğ°ÑÑ‚ÑÑ orchestrator, EventBus, CCXT-ĞºĞ»Ğ¸ĞµĞ½Ñ‚, InstanceLock Ğ¾ÑĞ²Ğ¾Ğ±Ğ¾Ğ¶Ğ´Ğ°ĞµÑ‚ÑÑ.



Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ğ¸: Gate.io (CCXT), Redis, SQLite, Alertmanagerâ†’Telegram, Telegram-Ğ±Ğ¾Ñ‚.



ĞœÑƒĞ»ÑŒÑ‚Ğ¸ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ: Ğ¿Ğ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºĞ° SYMBOLS Ğ²Ğ¾ Ğ²ÑĞµÑ… ÑƒĞ·Ğ»Ğ°Ñ… (orchestrator/PnL/reconciler).



ĞĞ°Ğ±Ğ»ÑĞ´Ğ°ĞµĞ¼Ğ¾ÑÑ‚ÑŒ: Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸ Ğ¸ health-Ñ‡ĞµĞºĞ¸ ÑĞ¾Ğ¾Ñ‚Ğ²ĞµÑ‚ÑÑ‚Ğ²ÑƒÑÑ‚ Ğ¾Ğ¿Ğ¸ÑĞ°Ğ½Ğ¸Ñ.



Prod-Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ğ½Ğ¾ÑÑ‚ÑŒ: Railway Ğ¼Ğ°Ğ½Ğ¸Ñ„ĞµÑÑ‚/ÑĞµĞºÑ€ĞµÑ‚Ñ‹/Ğ¿ĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ, Ğ±ÑĞºĞ°Ğ¿Ñ‹ Ğ‘Ğ” Ğ¸ Ğ²Ğ¾ÑÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ.



CI: ruff + mypy + pytest + import-linter (Ğ²ĞºĞ»ÑÑ‡Ğ°Ñ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»Ğ° Ğ¿Ğ¾ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞµ Ğ¸ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğ¹: ruff BLE, TRY).



ğŸš€ Ğ”ĞµĞ¿Ğ»Ğ¾Ğ¹ Ğ½Ğ° Railway



Procfile



web: uvicorn crypto\_ai\_bot.app.server:app --host 0.0.0.0 --port $PORT

worker: python -m crypto\_ai\_bot.cli.health\_monitor --daemon





Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ğ¸: Railway (Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ), Redis (ÑˆĞ¸Ğ½Ğ° ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğ¹), Prometheus/Alertmanager/Grafana (Ğ²Ğ½ĞµÑˆĞ½Ğ¸Ğµ, Ğ²ĞµĞ±Ñ…ÑƒĞº Ğ² Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ), SQLite (WAL) + Ğ±ÑĞºĞ°Ğ¿Ñ‹/Ñ€Ğ¾Ñ‚Ğ°Ñ†Ğ¸Ñ.



ĞŸÑ€Ğ¸Ğ¼ĞµÑ‡Ğ°Ğ½Ğ¸Ñ Ğ¿Ğ¾ Ñ‡Ğ¸ÑÑ‚ĞºĞµ Ğ°Ñ€Ñ‚ĞµÑ„Ğ°ĞºÑ‚Ğ¾Ğ²



ĞšĞ¾Ğ³Ğ´Ğ° Ğ²ÑĞµ Ğ¸Ğ¼Ğ¿Ğ¾Ñ€Ñ‚Ñ‹ Ğ¿ĞµÑ€ĞµĞ²ĞµĞ´ĞµĞ½Ñ‹ Ğ½Ğ° execute\_trade, Ñ„Ğ°Ğ¹Ğ»-Ğ¼Ğ¾ÑÑ‚Ğ¸Ğº place\_order.py Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ ÑƒĞ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ.



Ğ Ğ°Ğ½ĞµĞµ Ñ…Ñ€Ğ°Ğ½Ğ¸Ğ²ÑˆĞ¸Ğ¹ÑÑ Ğ² Ñ€ĞµĞ¿Ğ¾ ops/prometheus/ ÑƒĞ´Ğ°Ğ»Ñ‘Ğ½, Ñ‚.Ğº. Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ Ñ€Ğ°Ğ·Ğ²Ñ‘Ñ€Ğ½ÑƒÑ‚ ĞºĞ°Ğº Ğ²Ğ½ĞµÑˆĞ½Ğ¸Ğ¹ ÑĞµÑ€Ğ²Ğ¸Ñ Ğ½Ğ° Railway (ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³Ğ¸ Ğ´ĞµÑ€Ğ¶Ğ¸Ğ¼ Ñ‚Ğ°Ğ¼).

